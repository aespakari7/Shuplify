<nav>
    <a href="{% url 'admin_users' %}">ユーザー管理</a> | 
    <a href="{% url 'admin_prompts' %}">プロンプト管理へ</a> | 
</nav>

<h1>{{ message }}</h1>

<hr>
<h2>管理者ユーザー 一覧</h2>

<input type="text" id="adminSearch" onkeyup="filterUsers('adminSearch', 'adminList')" placeholder="名前 または ID で検索...">

<ul id="adminList">
{% for user in admin_users %}
    <li data-name="{{ user.name|lower }}" data-id="{{ user.user_id }}">
        管理者 {{ user.name }} (ID: {{ user.user_id }}) - 
        <span style="color: grey;">(削除不可)</span>
    </li>
{% empty %}
    <li>管理者ユーザーはいません。</li>
{% endfor %}
</ul>

<hr>
<h2>一般ユーザー 一覧</h2>

<input type="text" id="generalSearch" onkeyup="filterUsers('generalSearch', 'generalList')" placeholder="名前 または ID で検索...">

<ul id="generalList">
{% for user in general_users %}
    <li data-name="{{ user.name|lower }}" data-id="{{ user.user_id }}">
        {{ user.name }} (ID: {{ user.user_id }}) - 
        
        <form method="post" action="{% url 'delete_user' %}" style="display:inline;">
            {% csrf_token %}
            <input type="hidden" name="user_id" value="{{ user.user_id }}">
            <button type="submit" onclick="return confirm('本当に {{ user.name }} を削除（垢BAN）しますか？');">削除（垢BAN）</button>
        </form>
    </li>
{% empty %}
    <li>一般ユーザーが見つかりませんでした。</li>
{% endfor %}
</ul>

<script>
    function filterUsers(inputId, listId) {
        const input = document.getElementById(inputId);
        const filter = input.value.toLowerCase(); // 検索キーワード
        const ul = document.getElementById(listId);
        const li = ul.getElementsByTagName('li');

        for (let i = 0; i < li.length; i++) {
            const name = li[i].getAttribute('data-name');
            const id = li[i].getAttribute('data-id'); // IDを取得
            
            if (
                (name && name.indexOf(filter) > -1) ||
                (id && id.indexOf(filter) > -1)
            ) {
                li[i].style.display = ""; // 表示
            } else {
                li[i].style.display = "none"; // 非表示
            }
        }
    }
</script>